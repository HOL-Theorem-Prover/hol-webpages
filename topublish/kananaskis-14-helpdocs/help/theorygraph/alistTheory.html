<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head><link rel="icon" href="../../../images/logo.ico" type="image/vnd.microsoft.icon"><title>Theory: alist</title><meta http-equiv="content-type" content="text/html;charset=UTF-8">
<style type="text/css">
<!--
  body {background: #faf0e6; color: #191970; }
  span.freevar  { color: blue}
  span.boundvar { color: green}
  span.typevar  { color: purple}
  span.type     { color: teal}
  span.strong   { color: black; font-weight: bold}
  span.vstrong  { color: black; 
                  font-weight: bold;
                  font-size: larger}
  h1 {color: black}
  th {color: crimson}
-->
</style>
</head>
<body>
<h1>Theory "alist"</h1>
<span class="vstrong">Parents</span>&nbsp;&nbsp;&nbsp;&nbsp;
    <a href = "finite_mapTheory.html"><span class="strong">finite_map</span></a>

<h1>Signature</h1>
<center>
    <table BORDER=4 CELLPADDING=10 CELLSPACING=1>
    
    <tr> <th> Constant <th> Type<tr><td>
    <span class="strong">ADELKEY</span>
    <td>
    :Œ± -> (Œ± # Œ≤) list -> (Œ± # Œ≤) list
    <tr><td>
    <span class="strong">AFUPDKEY</span>
    <td>
    :Œ± -> (Œ≤ -> Œ≤) -> (Œ± # Œ≤) list -> (Œ± # Œ≤) list
    <tr><td>
    <span class="strong">ALOOKUP</span>
    <td>
    :(Œ≤ # Œ±) list -> Œ≤ -> Œ± option
    <tr><td>
    <span class="strong">alist_range</span>
    <td>
    :(Œ≤ # Œ±) list -> Œ± -> bool
    <tr><td>
    <span class="strong">alist_to_fmap</span>
    <td>
    :(Œ± # Œ≤) list -> (Œ± |-> Œ≤)
    <tr><td>
    <span class="strong">fmap_to_alist</span>
    <td>
    :(Œ± |-> Œ≤) -> (Œ± # Œ≤) list
    
</table>
</center>

<h1>Definitions</h1>
<DL>
<DT><span class="strong">ADELKEY_def</span>
<DD>
<pre>
‚ä¢ ‚àÄk alist. ADELKEY k alist = FILTER (Œªp. FST p ‚â† k) alist
</pre>

<DT><span class="strong">alist_range_def</span>
<DD>
<pre>
‚ä¢ ‚àÄm. alist_range m = {v | ‚àÉk. ALOOKUP m k = SOME v}
</pre>

<DT><span class="strong">alist_to_fmap_def</span>
<DD>
<pre>
‚ä¢ ‚àÄs. alist_to_fmap s = FOLDR (Œª(k,v) f. f |+ (k,v)) FEMPTY s
</pre>

<DT><span class="strong">fmap_to_alist_def</span>
<DD>
<pre>
‚ä¢ ‚àÄs. fmap_to_alist s = MAP (Œªk. (k,s ' k)) (SET_TO_LIST (FDOM s))
</pre>

</DL>


<hr>

<hr>
<h1>Theorems</h1>
<DL>
<DT><span class="strong">ADELKEY_AFUPDKEY</span>
<DD>
<pre>
‚ä¢ ‚àÄls f x y.
    x ‚â† y ‚áí (ADELKEY x (AFUPDKEY y f ls) = AFUPDKEY y f (ADELKEY x ls))
</pre>

<DT><span class="strong">ADELKEY_AFUPDKEY_same</span>
<DD>
<pre>
‚ä¢ ‚àÄfd f ls. ADELKEY fd (AFUPDKEY fd f ls) = ADELKEY fd ls
</pre>

<DT><span class="strong">ADELKEY_unchanged</span>
<DD>
<pre>
‚ä¢ ‚àÄx ls. (ADELKEY x ls = ls) ‚áî ¬¨MEM x (MAP FST ls)
</pre>

<DT><span class="strong">AFUPDKEY_ALOOKUP</span>
<DD>
<pre>
‚ä¢ ALOOKUP (AFUPDKEY k2 f al) k1 =
  case ALOOKUP al k1 of
    NONE => NONE
  | SOME v => if k1 = k2 then SOME (f v) else SOME v
</pre>

<DT><span class="strong">AFUPDKEY_I</span>
<DD>
<pre>
‚ä¢ AFUPDKEY n I = I
</pre>

<DT><span class="strong">AFUPDKEY_comm</span>
<DD>
<pre>
‚ä¢ ‚àÄk1 k2 f1 f2 l.
    k1 ‚â† k2 ‚áí
    (AFUPDKEY k2 f2 (AFUPDKEY k1 f1 l) = AFUPDKEY k1 f1 (AFUPDKEY k2 f2 l))
</pre>

<DT><span class="strong">AFUPDKEY_def</span>
<DD>
<pre>
‚ä¢ (‚àÄk f. AFUPDKEY k f [] = []) ‚àß
  ‚àÄv rest k' k f.
    AFUPDKEY k f ((k',v)::rest) =
    if k = k' then (k,f v)::rest else (k',v)::AFUPDKEY k f rest
</pre>

<DT><span class="strong">AFUPDKEY_eq</span>
<DD>
<pre>
‚ä¢ ‚àÄk f1 l f2.
    (‚àÄv. (ALOOKUP l k = SOME v) ‚áí (f1 v = f2 v)) ‚áí
    (AFUPDKEY k f1 l = AFUPDKEY k f2 l)
</pre>

<DT><span class="strong">AFUPDKEY_ind</span>
<DD>
<pre>
‚ä¢ ‚àÄP. (‚àÄk f. P k f []) ‚àß
      (‚àÄk f k' v rest. (k ‚â† k' ‚áí P k f rest) ‚áí P k f ((k',v)::rest)) ‚áí
      ‚àÄv v1 v2. P v v1 v2
</pre>

<DT><span class="strong">AFUPDKEY_o</span>
<DD>
<pre>
‚ä¢ AFUPDKEY k f1 (AFUPDKEY k f2 al) = AFUPDKEY k (f1 ‚àò f2) al
</pre>

<DT><span class="strong">AFUPDKEY_unchanged</span>
<DD>
<pre>
‚ä¢ ‚àÄk f alist.
    (‚àÄv. (ALOOKUP alist k = SOME v) ‚áí (f v = v)) ‚áí
    (AFUPDKEY k f alist = alist)
</pre>

<DT><span class="strong">ALL_DISTINCT_FEVERY_alist_to_fmap</span>
<DD>
<pre>
‚ä¢ ALL_DISTINCT (MAP FST ls) ‚áí (FEVERY P (alist_to_fmap ls) ‚áî EVERY P ls)
</pre>

<DT><span class="strong">ALL_DISTINCT_fmap_to_alist_keys</span>
<DD>
<pre>
‚ä¢ ‚àÄfm. ALL_DISTINCT (MAP FST (fmap_to_alist fm))
</pre>

<DT><span class="strong">ALOOKUP_ADELKEY</span>
<DD>
<pre>
‚ä¢ ‚àÄal. ALOOKUP (ADELKEY k1 al) k2 = if k1 = k2 then NONE else ALOOKUP al k2
</pre>

<DT><span class="strong">ALOOKUP_ALL_DISTINCT_EL</span>
<DD>
<pre>
‚ä¢ ‚àÄls n.
    n < LENGTH ls ‚àß ALL_DISTINCT (MAP FST ls) ‚áí
    (ALOOKUP ls (FST (EL n ls)) = SOME (SND (EL n ls)))
</pre>

<DT><span class="strong">ALOOKUP_ALL_DISTINCT_MEM</span>
<DD>
<pre>
‚ä¢ ALL_DISTINCT (MAP FST al) ‚àß MEM (k,v) al ‚áí (ALOOKUP al k = SOME v)
</pre>

<DT><span class="strong">ALOOKUP_ALL_DISTINCT_PERM_same</span>
<DD>
<pre>
‚ä¢ ‚àÄl1 l2.
    ALL_DISTINCT (MAP FST l1) ‚àß PERM (MAP FST l1) (MAP FST l2) ‚àß
    (LIST_TO_SET l1 = LIST_TO_SET l2) ‚áí
    (ALOOKUP l1 = ALOOKUP l2)
</pre>

<DT><span class="strong">ALOOKUP_APPEND</span>
<DD>
<pre>
‚ä¢ ‚àÄl1 l2 k.
    ALOOKUP (l1 ++ l2) k =
    case ALOOKUP l1 k of NONE => ALOOKUP l2 k | SOME v => SOME v
</pre>

<DT><span class="strong">ALOOKUP_APPEND_same</span>
<DD>
<pre>
‚ä¢ ‚àÄl1 l2 l.
    (ALOOKUP l1 = ALOOKUP l2) ‚áí (ALOOKUP (l1 ++ l) = ALOOKUP (l2 ++ l))
</pre>

<DT><span class="strong">ALOOKUP_EQ_FLOOKUP</span>
<DD>
<pre>
‚ä¢ (FLOOKUP (alist_to_fmap al) = ALOOKUP al) ‚àß
  (ALOOKUP (fmap_to_alist fm) = FLOOKUP fm)
</pre>

<DT><span class="strong">ALOOKUP_FAILS</span>
<DD>
<pre>
‚ä¢ (ALOOKUP l x = NONE) ‚áî ‚àÄk v. MEM (k,v) l ‚áí k ‚â† x
</pre>

<DT><span class="strong">ALOOKUP_FILTER</span>
<DD>
<pre>
‚ä¢ ‚àÄls x.
    ALOOKUP (FILTER (Œª(k,v). P k) ls) x = if P x then ALOOKUP ls x else NONE
</pre>

<DT><span class="strong">ALOOKUP_IN_FRANGE</span>
<DD>
<pre>
‚ä¢ ‚àÄls k v. (ALOOKUP ls k = SOME v) ‚áí v ‚àà FRANGE (alist_to_fmap ls)
</pre>

<DT><span class="strong">ALOOKUP_LEAST_EL</span>
<DD>
<pre>
‚ä¢ ‚àÄls k.
    ALOOKUP ls k =
    if MEM k (MAP FST ls) then
      SOME (EL (LEAST n. EL n (MAP FST ls) = k) (MAP SND ls))
    else NONE
</pre>

<DT><span class="strong">ALOOKUP_MAP</span>
<DD>
<pre>
‚ä¢ ‚àÄf al. ALOOKUP (MAP (Œª(x,y). (x,f y)) al) = OPTION_MAP f ‚àò ALOOKUP al
</pre>

<DT><span class="strong">ALOOKUP_MAP_2</span>
<DD>
<pre>
‚ä¢ ‚àÄf al x.
    ALOOKUP (MAP (Œª(x,y). (x,f x y)) al) x = OPTION_MAP (f x) (ALOOKUP al x)
</pre>

<DT><span class="strong">ALOOKUP_MEM</span>
<DD>
<pre>
‚ä¢ ‚àÄal k v. (ALOOKUP al k = SOME v) ‚áí MEM (k,v) al
</pre>

<DT><span class="strong">ALOOKUP_NONE</span>
<DD>
<pre>
‚ä¢ ‚àÄl x. (ALOOKUP l x = NONE) ‚áî ¬¨MEM x (MAP FST l)
</pre>

<DT><span class="strong">ALOOKUP_SOME_FAPPLY_alist_to_fmap</span>
<DD>
<pre>
‚ä¢ ‚àÄal k v. (ALOOKUP al k = SOME v) ‚áí (alist_to_fmap al ' k = v)
</pre>

<DT><span class="strong">ALOOKUP_TABULATE</span>
<DD>
<pre>
‚ä¢ MEM x l ‚áí (ALOOKUP (MAP (Œªk. (k,f k)) l) x = SOME (f x))
</pre>

<DT><span class="strong">ALOOKUP_ZIP_MAP_SND</span>
<DD>
<pre>
‚ä¢ ‚àÄl1 l2 k f.
    (LENGTH l1 = LENGTH l2) ‚áí
    (ALOOKUP (ZIP (l1,MAP f l2)) = OPTION_MAP f ‚àò ALOOKUP (ZIP (l1,l2)))
</pre>

<DT><span class="strong">ALOOKUP_def</span>
<DD>
<pre>
‚ä¢ (‚àÄq. ALOOKUP [] q = NONE) ‚àß
  ‚àÄy x t q. ALOOKUP ((x,y)::t) q = if x = q then SOME y else ALOOKUP t q
</pre>

<DT><span class="strong">ALOOKUP_ind</span>
<DD>
<pre>
‚ä¢ ‚àÄP. (‚àÄq. P [] q) ‚àß (‚àÄx y t q. (x ‚â† q ‚áí P t q) ‚áí P ((x,y)::t) q) ‚áí
      ‚àÄv v1. P v v1
</pre>

<DT><span class="strong">ALOOKUP_prefix</span>
<DD>
<pre>
‚ä¢ ‚àÄls k ls2.
    ((ALOOKUP ls k = SOME v) ‚áí (ALOOKUP (ls ++ ls2) k = SOME v)) ‚àß
    ((ALOOKUP ls k = NONE) ‚áí (ALOOKUP (ls ++ ls2) k = ALOOKUP ls2 k))
</pre>

<DT><span class="strong">FDOM_alist_to_fmap</span>
<DD>
<pre>
‚ä¢ ‚àÄal. FDOM (alist_to_fmap al) = LIST_TO_SET (MAP FST al)
</pre>

<DT><span class="strong">FEVERY_alist_to_fmap</span>
<DD>
<pre>
‚ä¢ EVERY P ls ‚áí FEVERY P (alist_to_fmap ls)
</pre>

<DT><span class="strong">FLOOKUP_FUPDATE_LIST_ALOOKUP_NONE</span>
<DD>
<pre>
‚ä¢ (ALOOKUP ls k = NONE) ‚áí (FLOOKUP (fm |++ REVERSE ls) k = FLOOKUP fm k)
</pre>

<DT><span class="strong">FLOOKUP_FUPDATE_LIST_ALOOKUP_SOME</span>
<DD>
<pre>
‚ä¢ (ALOOKUP ls k = SOME v) ‚áí (FLOOKUP (fm |++ REVERSE ls) k = SOME v)
</pre>

<DT><span class="strong">FRANGE_alist_to_fmap_SUBSET</span>
<DD>
<pre>
‚ä¢ FRANGE (alist_to_fmap ls) ‚äÜ IMAGE SND (LIST_TO_SET ls)
</pre>

<DT><span class="strong">FUNION_alist_to_fmap</span>
<DD>
<pre>
‚ä¢ ‚àÄls fm. alist_to_fmap ls FUNION fm = fm |++ REVERSE ls
</pre>

<DT><span class="strong">FUPDATE_LIST_EQ_APPEND_REVERSE</span>
<DD>
<pre>
‚ä¢ ‚àÄls fm. fm |++ ls = alist_to_fmap (REVERSE ls ++ fmap_to_alist fm)
</pre>

<DT><span class="strong">IN_FRANGE_alist_to_fmap_suff</span>
<DD>
<pre>
‚ä¢ (‚àÄv. MEM v (MAP SND ls) ‚áí P v) ‚áí ‚àÄv. v ‚àà FRANGE (alist_to_fmap ls) ‚áí P v
</pre>

<DT><span class="strong">LENGTH_AFUPDKEY</span>
<DD>
<pre>
‚ä¢ ‚àÄls. LENGTH (AFUPDKEY k f ls) = LENGTH ls
</pre>

<DT><span class="strong">LENGTH_fmap_to_alist</span>
<DD>
<pre>
‚ä¢ ‚àÄfm. LENGTH (fmap_to_alist fm) = CARD (FDOM fm)
</pre>

<DT><span class="strong">MAP_FST_AFUPDKEY</span>
<DD>
<pre>
‚ä¢ MAP FST (AFUPDKEY f k alist) = MAP FST alist
</pre>

<DT><span class="strong">MAP_KEYS_I</span>
<DD>
<pre>
‚ä¢ ‚àÄfm. MAP_KEYS I fm = fm
</pre>

<DT><span class="strong">MAP_values_fmap_to_alist</span>
<DD>
<pre>
‚ä¢ ‚àÄf fm. MAP (Œª(k,v). (k,f v)) (fmap_to_alist fm) = fmap_to_alist (f o_f fm)
</pre>

<DT><span class="strong">MEM_ADELKEY</span>
<DD>
<pre>
‚ä¢ ‚àÄal. MEM (k1,v) (ADELKEY k2 al) ‚áî k1 ‚â† k2 ‚àß MEM (k1,v) al
</pre>

<DT><span class="strong">MEM_fmap_to_alist</span>
<DD>
<pre>
‚ä¢ MEM (x,y) (fmap_to_alist fm) ‚áî x ‚àà FDOM fm ‚àß (fm ' x = y)
</pre>

<DT><span class="strong">MEM_fmap_to_alist_FLOOKUP</span>
<DD>
<pre>
‚ä¢ ‚àÄp fm. MEM p (fmap_to_alist fm) ‚áî (FLOOKUP fm (FST p) = SOME (SND p))
</pre>

<DT><span class="strong">MEM_pair_fmap_to_alist_FLOOKUP</span>
<DD>
<pre>
‚ä¢ ‚àÄx y fm. MEM (x,y) (fmap_to_alist fm) ‚áî (FLOOKUP fm x = SOME y)
</pre>

<DT><span class="strong">PERM_fmap_to_alist</span>
<DD>
<pre>
‚ä¢ PERM (fmap_to_alist fm1) (fmap_to_alist fm2) ‚áî (fm1 = fm2)
</pre>

<DT><span class="strong">alist_to_fmap_APPEND</span>
<DD>
<pre>
‚ä¢ ‚àÄl1 l2. alist_to_fmap (l1 ++ l2) = alist_to_fmap l1 FUNION alist_to_fmap l2
</pre>

<DT><span class="strong">alist_to_fmap_FAPPLY_MEM</span>
<DD>
<pre>
‚ä¢ ‚àÄal z. z ‚àà FDOM (alist_to_fmap al) ‚áí MEM (z,alist_to_fmap al ' z) al
</pre>

<DT><span class="strong">alist_to_fmap_MAP</span>
<DD>
<pre>
‚ä¢ ‚àÄf1 f2 al.
    INJ f1 (LIST_TO_SET (MAP FST al)) ùïå(:Œ≤) ‚áí
    (alist_to_fmap (MAP (Œª(x,y). (f1 x,f2 y)) al) =
     MAP_KEYS f1 (f2 o_f alist_to_fmap al))
</pre>

<DT><span class="strong">alist_to_fmap_MAP_matchable</span>
<DD>
<pre>
‚ä¢ ‚àÄf1 f2 al mal v.
    INJ f1 (LIST_TO_SET (MAP FST al)) ùïå(:Œ≤) ‚àß
    (mal = MAP (Œª(x,y). (f1 x,f2 y)) al) ‚àß
    (v = MAP_KEYS f1 (f2 o_f alist_to_fmap al)) ‚áí
    (alist_to_fmap mal = v)
</pre>

<DT><span class="strong">alist_to_fmap_MAP_values</span>
<DD>
<pre>
‚ä¢ ‚àÄf al. alist_to_fmap (MAP (Œª(k,v). (k,f v)) al) = f o_f alist_to_fmap al
</pre>

<DT><span class="strong">alist_to_fmap_PERM</span>
<DD>
<pre>
‚ä¢ ‚àÄl1 l2.
    PERM l1 l2 ‚àß ALL_DISTINCT (MAP FST l1) ‚áí
    (alist_to_fmap l1 = alist_to_fmap l2)
</pre>

<DT><span class="strong">alist_to_fmap_prefix</span>
<DD>
<pre>
‚ä¢ ‚àÄls l1 l2.
    (alist_to_fmap l1 = alist_to_fmap l2) ‚áí
    (alist_to_fmap (ls ++ l1) = alist_to_fmap (ls ++ l2))
</pre>

<DT><span class="strong">alist_to_fmap_thm</span>
<DD>
<pre>
‚ä¢ (alist_to_fmap [] = FEMPTY) ‚àß
  (alist_to_fmap ((k,v)::t) = alist_to_fmap t |+ (k,v))
</pre>

<DT><span class="strong">alist_to_fmap_to_alist</span>
<DD>
<pre>
‚ä¢ ‚àÄal.
    fmap_to_alist (alist_to_fmap al) =
    MAP (Œªk. (k,THE (ALOOKUP al k))) (SET_TO_LIST (LIST_TO_SET (MAP FST al)))
</pre>

<DT><span class="strong">alist_to_fmap_to_alist_PERM</span>
<DD>
<pre>
‚ä¢ ‚àÄal. ALL_DISTINCT (MAP FST al) ‚áí PERM (fmap_to_alist (alist_to_fmap al)) al
</pre>

<DT><span class="strong">alookup_distinct_reverse</span>
<DD>
<pre>
‚ä¢ ‚àÄl k. ALL_DISTINCT (MAP FST l) ‚áí (ALOOKUP (REVERSE l) k = ALOOKUP l k)
</pre>

<DT><span class="strong">alookup_filter</span>
<DD>
<pre>
‚ä¢ ‚àÄf l x. ALOOKUP l x = ALOOKUP (FILTER (Œª(x',y). x = x') l) x
</pre>

<DT><span class="strong">alookup_stable_sorted</span>
<DD>
<pre>
‚ä¢ ‚àÄR sort x l.
    transitive R ‚àß total R ‚àß STABLE sort (inv_image R FST) ‚áí
    (ALOOKUP (sort (inv_image R FST) l) x = ALOOKUP l x)
</pre>

<DT><span class="strong">flookup_fupdate_list</span>
<DD>
<pre>
‚ä¢ ‚àÄl k m.
    FLOOKUP (m |++ l) k =
    case ALOOKUP (REVERSE l) k of NONE => FLOOKUP m k | SOME v => SOME v
</pre>

<DT><span class="strong">fmap_to_alist_FEMPTY</span>
<DD>
<pre>
‚ä¢ fmap_to_alist FEMPTY = []
</pre>

<DT><span class="strong">fmap_to_alist_inj</span>
<DD>
<pre>
‚ä¢ ‚àÄf1 f2. (fmap_to_alist f1 = fmap_to_alist f2) ‚áí (f1 = f2)
</pre>

<DT><span class="strong">fmap_to_alist_preserves_FDOM</span>
<DD>
<pre>
‚ä¢ ‚àÄfm1 fm2.
    (FDOM fm1 = FDOM fm2) ‚áí
    (MAP FST (fmap_to_alist fm1) = MAP FST (fmap_to_alist fm2))
</pre>

<DT><span class="strong">fmap_to_alist_to_fmap</span>
<DD>
<pre>
‚ä¢ alist_to_fmap (fmap_to_alist fm) = fm
</pre>

<DT><span class="strong">fupdate_list_funion</span>
<DD>
<pre>
‚ä¢ ‚àÄm l. m |++ l = FEMPTY |++ l FUNION m
</pre>

<DT><span class="strong">mem_to_flookup</span>
<DD>
<pre>
‚ä¢ ‚àÄx y l.
    ALL_DISTINCT (MAP FST l) ‚àß MEM (x,y) l ‚áí
    (FLOOKUP (FEMPTY |++ l) x = SOME y)
</pre>

<DT><span class="strong">set_MAP_FST_fmap_to_alist</span>
<DD>
<pre>
‚ä¢ LIST_TO_SET (MAP FST (fmap_to_alist fm)) = FDOM fm
</pre>

</DL>



<hr>
</body>
</html>
