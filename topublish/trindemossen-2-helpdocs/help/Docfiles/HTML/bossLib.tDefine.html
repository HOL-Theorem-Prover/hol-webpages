<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>bossLib.tDefine</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      border: none;
      border-top: 1px solid #1a1a1a;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
</head>
<body>
<h2 id="tdefine"><code>tDefine</code></h2>
<pre class="hol4"><code>bossLib.tDefine : string -&gt; term quotation -&gt; tactic -&gt; thm</code></pre>
<hr />
<p>General-purpose function definition facility.</p>
<p><code>tDefine</code> is a definition package similar to
<code>Define</code> except that it has a tactic parameter which is used
to perform the termination proof for the specified function.
<code>tDefine</code> accepts the same syntax used by <code>Define</code>
for specifying functions.</p>
<p>If the specification is a simple abbreviation, or is primitive
recursive (i.e., it exactly follows the recursion pattern of a
previously declared HOL datatype) then the invocation of
<code>tDefine</code> succeeds and stores the derived equations in the
current theory segment. Otherwise, the function is not an instance of
primitive recursion, and the termination prover may succeed or fail.</p>
<p>When processing the specification of a recursive function,
<code>tDefine</code> must perform a termination proof. It automatically
constructs termination conditions for the function, and invokes the
supplied tactic in an attempt to prove the termination conditions. If
that attempt fails, then <code>tDefine</code> fails.</p>
<p>If it succeeds, then <code>tDefine</code> stores the specified
equations in the current theory segment, using the string argument as a
stem for the name. An induction theorem customized for the defined
function is also stored in the current segment. Note, however, that an
induction theorem is not stored for primitive recursive functions, since
that theorem would be identical to the induction theorem resulting from
the declaration of the datatype.</p>
<p>If the tactic application fails, then <code>tDefine</code> fails.</p>
<h3 id="failure">Failure</h3>
<p><code>tDefine</code> fails if its input fails to parse and
typecheck.</p>
<p><code>tDefine</code> fails if it cannot prove the termination of the
specified recursive function. In that case, one has to embark on the
following multi-step process: (1) construct the function and synthesize
its termination conditions with <code>Hol_defn</code>; (2) set up a goal
to prove the termination conditions with <code>tgoal</code>; (3)
interactively prove the termination conditions, usually by starting with
an invocation of <code>WF_REL_TAC</code>; and (4) package everything up
with an invocation of <code>tDefine</code>.</p>
<h3 id="example">Example</h3>
<p>The following attempt to invoke <code>Define</code> fails because the
current default termination prover for <code>Define</code> is too
weak:</p>
<pre class="hol4"><code>   Hol_datatype`foo = c1 | c2 | c3`;

   Define `(f c1 x = x) /\
           (f c2 x = x + 3) /\
           (f c3 x = f c2 (x + 6))`;</code></pre>
<p>The following invocation of <code>tDefine</code> uses the supplied
tactic to prove termination.</p>
<pre class="hol4"><code>   tDefine &quot;f&quot;
      `(f c1 x = x) /\
       (f c2 x = x + 3) /\
       (f c3 x = f c2 (x + 6))`
    (WF_REL_TAC `measure (\p. case FST p of c3 -&gt; 1 || _ -&gt; 0)`);

   Equations stored under &quot;f_def&quot;.
   Induction stored under &quot;f_ind&quot;.
   &gt; val it = |- (f c1 x = x) /\ (f c2 x = x + 3) /\ (f c3 x = f c2 (x + 6)) : thm</code></pre>
<h3 id="comments">Comments</h3>
<p><code>tDefine</code> automatically adds the definition it makes into
the hidden ‘compset’ accessed by <code>EVAL</code> and
<code>EVAL_TAC</code>.</p>
<h3 id="see-also">See also</h3>
<p><a href="bossLib.Define.html"><code>bossLib.Define</code></a>, <a
href="bossLib.xDefine.html"><code>bossLib.xDefine</code></a>, <a
href="TotalDefn.DefineSchema.html"><code>TotalDefn.DefineSchema</code></a>,
<a href="bossLib.Hol_defn.html"><code>bossLib.Hol_defn</code></a>, <a
href="Defn.tgoal.html"><code>Defn.tgoal</code></a>, <a
href="Defn.tprove.html"><code>Defn.tprove</code></a>, <a
href="bossLib.WF_REL_TAC.html"><code>bossLib.WF_REL_TAC</code></a>, <a
href="bossLib.recInduct.html"><code>bossLib.recInduct</code></a>, <a
href="bossLib.EVAL.html"><code>bossLib.EVAL</code></a>, <a
href="bossLib.EVAL_TAC.html"><code>bossLib.EVAL_TAC</code></a></p>
</body>
</html>
