<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Q.PAT_ABBREV_TAC</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      border: none;
      border-top: 1px solid #1a1a1a;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
</head>
<body>
<h2 id="pat_abbrev_tac"><code>PAT_ABBREV_TAC</code></h2>
<pre class="hol4"><code>Q.PAT_ABBREV_TAC : term quotation -&gt; tactic</code></pre>
<hr />
<p>Introduces an abbreviation within the goal statement.</p>
<p>When applied to the goal <code>(asl, w)</code>, the tactic
<code>Q.PAT_ABBREV_TAC q</code> parses the quotation <code>q</code> in
the context of the goal, producing an equality term <code>v = p</code>.
The tactic then uses <code>HolKernel.gen_find_term</code> to search for
a sub-term of <code>w</code> that <code>p</code> matches against. If
such a sub-term <code>t</code> is found then all occurrences of
<code>t</code> (in <code>asl</code> and <code>w</code>) will be replaced
by <code>v</code> and an assumption <code>Abbrev(v = t)</code> is added
to the goal.</p>
<p>The trace variable <code>"PAT_ABBREV_TAC: match var/const"</code>
controls whether or not trivial matches (with constants or variables)
are allowed. By default trivial matches are permitted but when the trace
variable is false the tactic will ignore trivial matches, which could
result in failure.</p>
<h3 id="failure">Failure</h3>
<p><code>PAT_ABBREV_TAC</code> fails if <code>q</code> does not
successfully parse as an equality or if no matching sub-term is found in
the goal, or if the only matching sub-terms would bind pattern variables
to variables that are bound in the goal.</p>
<h3 id="example">Example</h3>
<p>If the current goal is</p>
<pre class="hol4"><code>   ?- (n + 10) * y &lt;= 42315</code></pre>
<p>then applying the tactic
<code>Q.PAT_ABBREV_TAC `X = a * b: num`</code> results in the goal</p>
<pre class="hol4"><code>   Abbrev (X = (n + 10) * y)
      ?-
   X &lt;= 42315</code></pre>
<p>By default trivial matches are permitted. If the current goal is</p>
<pre class="hol4"><code>   ?- y &lt;= 42315</code></pre>
<p>then <code>Q.PAT_ABBREV_TAC `X = a: num`</code> will give</p>
<pre class="hol4"><code>   Abbrev (X = y)
      ?-
   X &lt;= 42315</code></pre>
<p>However, if this is not desirable then setting</p>
<pre class="hol4"><code>Feedback.set_trace &quot;PAT_ABBREV_TAC: match var/const&quot; 0</code></pre>
<p>and applying <code>Q.PAT_ABBREV_TAC `X = a: num`</code> will give</p>
<pre class="hol4"><code>   Abbrev (X = 42315)
      ?-
   y &lt;= X</code></pre>
<p>If the current goal is</p>
<pre class="hol4"><code>   ?- !x. x &lt; 3</code></pre>
<p>then applying <code>Q.PAT_ABBREV_TAC `v = (a &lt; b)`</code> will
result in a failure because the patternâ€™s variable <code>a</code> would
have to bind the bound variable <code>x</code> in the goal.</p>
<h3 id="see-also">See also</h3>
<p><a href="Q.ABBREV_TAC.html"><code>Q.ABBREV_TAC</code></a>, <a
href="HolKernel.gen_find_term.html"><code>HolKernel.gen_find_term</code></a>,
<a
href="Q.MATCH_ABBREV_TAC.html"><code>Q.MATCH_ABBREV_TAC</code></a></p>
</body>
</html>
