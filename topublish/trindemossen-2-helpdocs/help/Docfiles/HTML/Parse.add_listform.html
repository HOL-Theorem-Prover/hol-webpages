<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Parse.add_listform</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      border: none;
      border-top: 1px solid #1a1a1a;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
</head>
<body>
<h2 id="add_listform"><code>add_listform</code></h2>
<pre class="hol4"><code>Parse.add_listform :
  {separator : pp_element list, leftdelim : pp_element list,
   rightdelim : pp_element list, cons : string, nilstr : string,
   block_info : term_grammar.block_info } -&gt;
  unit</code></pre>
<hr />
<p>Adds a “list-form” to the built-in grammar, allowing the parsing of
strings such as <code>[a; b; c]</code> and <code>{}</code>.</p>
<p>The <code>add_listform</code> function allows the user to augment the
HOL parser with rules so that it can turn a string of the form</p>
<pre class="hol4"><code>   &lt;ld&gt; str1 &lt;sep&gt; str2 &lt;sep&gt; ... strn &lt;rd&gt;</code></pre>
<p>into the term</p>
<pre class="hol4"><code>   &lt;cons&gt; t1 (&lt;cons&gt; t2 ... (&lt;cons&gt; tn &lt;nilstr&gt;))</code></pre>
<p>where <code>&lt;ld&gt;</code> is the left delimiter string,
<code>&lt;rd&gt;</code> the right delimiter, and
<code>&lt;sep&gt;</code> is the separator string from the fields of the
record argument to the function. The various <code>stri</code> are
strings representing the <code>ti</code> terms. Further, the grammar
will also parse <code>&lt;ld&gt; &lt;rd&gt;</code> into
<code>&lt;nilstr&gt;</code>.</p>
<p>The <code>pp_element</code> lists passed to this function for the
<code>separator</code>, <code>leftdelim</code> and
<code>rightdelim</code> fields are interpreted as by the
<code>add_rule</code> function. These lists must have exactly one
<code>TOK</code> element (this provides the string that will be
printed), and other formatting elements such as
<code>BreakSpace</code>.</p>
<p>The <code>block_info</code> field is a pair consisting of a
“consistency” (<code>PP.CONSISTENT</code>, or
<code>PP.INCONSISTENT</code>), and an indentation depth (an integer).
The standard value for this field is <code>(PP.INCONSISTENT,0)</code>,
which will cause lists too long to fit in a single line to print with as
many elements on the first line as will fit, and for subsequent elements
to appear unindented on subsequent lines. Changing the “consistency” to
<code>PP.CONSISTENT</code> would cause lists too long for a single line
to print with one element per line. The indentation level number
specifies the number of extra spaces to be inserted when a line-break
occurs.</p>
<p>In common with the <code>add_rule</code> function, there is no
requirement that the <code>cons</code> and <code>nilstr</code> fields be
the names of constants; the parser/grammar combination will generate
variables with these names if there are no corresponding constants.</p>
<p>The HOL pretty-printer is simultaneously aware of the new rule, and
terms of the forms above will print appropriately.</p>
<h3 id="failure">Failure</h3>
<p>Fails if any of the <code>pp_element</code> lists are ill-formed: if
they include <code>TM</code>, <code>BeginFinalBlock</code>, or
<code>EndInitialBlock</code> elements, or if do not include exactly one
<code>TOK</code> element. Subsequent calls to the term parser may also
fail or behave unpredictably if the strings chosen for the various
fields above introduce precedence conflicts. For example, it will almost
always be impossible to use left and right delimiters that are already
present in the grammar, unless they are there as the left and right
parts of a closefix.</p>
<h3 id="example">Example</h3>
<p>The definition of the “list-form” for lists in the HOL distribution
is:</p>
<pre class="hol4"><code>   add_listform {separator = [TOK &quot;;&quot;, BreakSpace(1,0)],
                 leftdelim = [TOK &quot;[&quot;], rightdelim = [TOK &quot;]&quot;],
                 cons = &quot;CONS&quot;, nilstr = &quot;NIL&quot;,
                 block_info = (PP.INCONSISTENT, 0)};</code></pre>
<p>while the set syntax is defined similarly:</p>
<pre class="hol4"><code>   add_listform {leftdelim = [TOK &quot;{&quot;], rightdelim = TOK [&quot;}&quot;],
                 separator = [&quot;;&quot;, BreakSpace(1,0)],
                 cons = &quot;INSERT&quot;, nilstr = &quot;EMPTY&quot;,
                 block_info = (PP.INCONSISTENT, 0)};</code></pre>
<p>Used to make sequential term structures print and parse more
pleasingly.</p>
<h3 id="comments">Comments</h3>
<p>As with other parsing functions, there is a
<code>temp_add_listform</code> version of this function, which has the
same effect on the global grammar, but which does not cause this effect
to persist when the current theory is exported.</p>
<h3 id="see-also">See also</h3>
<p><a href="Parse.add_rule.html"><code>Parse.add_rule</code></a></p>
</body>
</html>
