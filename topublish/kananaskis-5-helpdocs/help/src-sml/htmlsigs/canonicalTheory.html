<HTML><head><link rel="icon" href="../../../../images/logo.ico" type="image/vnd.microsoft.icon"><TITLE>Structure canonicalTheory</TITLE></HEAD>
<BODY BGCOLOR="#fbf2e7">
<H1>Structure canonicalTheory</H1>
<HR><TABLE WIDTH=100%><TR ALIGN = CENTER>
<TH><A HREF="../../../src/ring/src/canonicalScript.sml" type="text/plain">Source File</A>
<TH><A HREF="idIndex.html">Identifier index</A>
<TH><A HREF="TheoryIndex.html">Theory binding index</A>
</TABLE><HR>
<PRE>
<A NAME="line1"></A>signature canonicalTheory =
<A NAME="line2"></A>sig
<A NAME="line3"></A>  type thm = Thm.thm
<A NAME="line4"></A>  
<A NAME="line5"></A>  (*  Definitions  *)
<A NAME="line6"></A>    val <A HREF="#canonical_sum_TY_DEF-val">canonical_sum_TY_DEF</A> : thm
<A NAME="line7"></A>    val <A HREF="#canonical_sum_case_def-val">canonical_sum_case_def</A> : thm
<A NAME="line8"></A>    val <A HREF="#canonical_sum_merge_curried_def-val">canonical_sum_merge_curried_def</A> : thm
<A NAME="line9"></A>    val <A HREF="#canonical_sum_merge_tupled_primitive_def-val">canonical_sum_merge_tupled_primitive_def</A> : thm
<A NAME="line10"></A>    val <A HREF="#canonical_sum_prod_def-val">canonical_sum_prod_def</A> : thm
<A NAME="line11"></A>    val <A HREF="#canonical_sum_repfns-val">canonical_sum_repfns</A> : thm
<A NAME="line12"></A>    val <A HREF="#canonical_sum_scalar2_def-val">canonical_sum_scalar2_def</A> : thm
<A NAME="line13"></A>    val <A HREF="#canonical_sum_scalar3_def-val">canonical_sum_scalar3_def</A> : thm
<A NAME="line14"></A>    val <A HREF="#canonical_sum_scalar_def-val">canonical_sum_scalar_def</A> : thm
<A NAME="line15"></A>    val <A HREF="#canonical_sum_simplify_def-val">canonical_sum_simplify_def</A> : thm
<A NAME="line16"></A>    val <A HREF="#canonical_sum_size_def-val">canonical_sum_size_def</A> : thm
<A NAME="line17"></A>    val <A HREF="#ics_aux_def-val">ics_aux_def</A> : thm
<A NAME="line18"></A>    val <A HREF="#interp_cs_def-val">interp_cs_def</A> : thm
<A NAME="line19"></A>    val <A HREF="#interp_m_def-val">interp_m_def</A> : thm
<A NAME="line20"></A>    val <A HREF="#interp_sp_def-val">interp_sp_def</A> : thm
<A NAME="line21"></A>    val <A HREF="#interp_vl_def-val">interp_vl_def</A> : thm
<A NAME="line22"></A>    val <A HREF="#ivl_aux_def-val">ivl_aux_def</A> : thm
<A NAME="line23"></A>    val <A HREF="#monom_insert_curried_def-val">monom_insert_curried_def</A> : thm
<A NAME="line24"></A>    val <A HREF="#monom_insert_tupled_primitive_def-val">monom_insert_tupled_primitive_def</A> : thm
<A NAME="line25"></A>    val <A HREF="#spolynom_TY_DEF-val">spolynom_TY_DEF</A> : thm
<A NAME="line26"></A>    val <A HREF="#spolynom_case_def-val">spolynom_case_def</A> : thm
<A NAME="line27"></A>    val <A HREF="#spolynom_normalize_def-val">spolynom_normalize_def</A> : thm
<A NAME="line28"></A>    val <A HREF="#spolynom_repfns-val">spolynom_repfns</A> : thm
<A NAME="line29"></A>    val <A HREF="#spolynom_simplify_def-val">spolynom_simplify_def</A> : thm
<A NAME="line30"></A>    val <A HREF="#spolynom_size_def-val">spolynom_size_def</A> : thm
<A NAME="line31"></A>    val <A HREF="#varlist_insert_curried_def-val">varlist_insert_curried_def</A> : thm
<A NAME="line32"></A>    val <A HREF="#varlist_insert_tupled_primitive_def-val">varlist_insert_tupled_primitive_def</A> : thm
<A NAME="line33"></A>  
<A NAME="line34"></A>  (*  Theorems  *)
<A NAME="line35"></A>    val <A HREF="#canonical_sum_11-val">canonical_sum_11</A> : thm
<A NAME="line36"></A>    val <A HREF="#canonical_sum_Axiom-val">canonical_sum_Axiom</A> : thm
<A NAME="line37"></A>    val <A HREF="#canonical_sum_case_cong-val">canonical_sum_case_cong</A> : thm
<A NAME="line38"></A>    val <A HREF="#canonical_sum_distinct-val">canonical_sum_distinct</A> : thm
<A NAME="line39"></A>    val <A HREF="#canonical_sum_induction-val">canonical_sum_induction</A> : thm
<A NAME="line40"></A>    val <A HREF="#canonical_sum_merge_def-val">canonical_sum_merge_def</A> : thm
<A NAME="line41"></A>    val <A HREF="#canonical_sum_merge_ind-val">canonical_sum_merge_ind</A> : thm
<A NAME="line42"></A>    val <A HREF="#canonical_sum_merge_ok-val">canonical_sum_merge_ok</A> : thm
<A NAME="line43"></A>    val <A HREF="#canonical_sum_nchotomy-val">canonical_sum_nchotomy</A> : thm
<A NAME="line44"></A>    val <A HREF="#canonical_sum_prod_ok-val">canonical_sum_prod_ok</A> : thm
<A NAME="line45"></A>    val <A HREF="#canonical_sum_scalar2_ok-val">canonical_sum_scalar2_ok</A> : thm
<A NAME="line46"></A>    val <A HREF="#canonical_sum_scalar3_ok-val">canonical_sum_scalar3_ok</A> : thm
<A NAME="line47"></A>    val <A HREF="#canonical_sum_scalar_ok-val">canonical_sum_scalar_ok</A> : thm
<A NAME="line48"></A>    val <A HREF="#canonical_sum_simplify_ok-val">canonical_sum_simplify_ok</A> : thm
<A NAME="line49"></A>    val <A HREF="#datatype_canonical_sum-val">datatype_canonical_sum</A> : thm
<A NAME="line50"></A>    val <A HREF="#datatype_spolynom-val">datatype_spolynom</A> : thm
<A NAME="line51"></A>    val <A HREF="#ics_aux_ok-val">ics_aux_ok</A> : thm
<A NAME="line52"></A>    val <A HREF="#interp_m_ok-val">interp_m_ok</A> : thm
<A NAME="line53"></A>    val <A HREF="#ivl_aux_ok-val">ivl_aux_ok</A> : thm
<A NAME="line54"></A>    val <A HREF="#monom_insert_def-val">monom_insert_def</A> : thm
<A NAME="line55"></A>    val <A HREF="#monom_insert_ind-val">monom_insert_ind</A> : thm
<A NAME="line56"></A>    val <A HREF="#monom_insert_ok-val">monom_insert_ok</A> : thm
<A NAME="line57"></A>    val <A HREF="#spolynom_11-val">spolynom_11</A> : thm
<A NAME="line58"></A>    val <A HREF="#spolynom_Axiom-val">spolynom_Axiom</A> : thm
<A NAME="line59"></A>    val <A HREF="#spolynom_case_cong-val">spolynom_case_cong</A> : thm
<A NAME="line60"></A>    val <A HREF="#spolynom_distinct-val">spolynom_distinct</A> : thm
<A NAME="line61"></A>    val <A HREF="#spolynom_induction-val">spolynom_induction</A> : thm
<A NAME="line62"></A>    val <A HREF="#spolynom_nchotomy-val">spolynom_nchotomy</A> : thm
<A NAME="line63"></A>    val <A HREF="#spolynomial_normalize_ok-val">spolynomial_normalize_ok</A> : thm
<A NAME="line64"></A>    val <A HREF="#spolynomial_simplify_ok-val">spolynomial_simplify_ok</A> : thm
<A NAME="line65"></A>    val <A HREF="#varlist_insert_def-val">varlist_insert_def</A> : thm
<A NAME="line66"></A>    val <A HREF="#varlist_insert_ind-val">varlist_insert_ind</A> : thm
<A NAME="line67"></A>    val <A HREF="#varlist_insert_ok-val">varlist_insert_ok</A> : thm
<A NAME="line68"></A>    val <A HREF="#varlist_merge_ok-val">varlist_merge_ok</A> : thm
<A NAME="line69"></A>  
<A NAME="line70"></A>  val canonical_grammars : type_grammar.grammar * term_grammar.grammar
<A NAME="line71"></A>  
<A NAME="line72"></A>  
<A NAME="line73"></A>  
<A NAME="line74"></A>  val IMPORT : abstraction.inst_infos -&gt;
<A NAME="line75"></A>    { interp_sp_def : thm,
<A NAME="line76"></A>      spolynom_simplify_def : thm,
<A NAME="line77"></A>      spolynom_normalize_def : thm,
<A NAME="line78"></A>      spolynom_size_def : thm,
<A NAME="line79"></A>      spolynom_case_def : thm,
<A NAME="line80"></A>      spolynom_repfns : thm,
<A NAME="line81"></A>      spolynom_TY_DEF : thm,
<A NAME="line82"></A>      interp_cs_def : thm,
<A NAME="line83"></A>      ics_aux_def : thm,
<A NAME="line84"></A>      interp_m_def : thm,
<A NAME="line85"></A>      interp_vl_def : thm,
<A NAME="line86"></A>      ivl_aux_def : thm,
<A NAME="line87"></A>      canonical_sum_simplify_def : thm,
<A NAME="line88"></A>      canonical_sum_prod_def : thm,
<A NAME="line89"></A>      canonical_sum_scalar3_def : thm,
<A NAME="line90"></A>      canonical_sum_scalar2_def : thm,
<A NAME="line91"></A>      canonical_sum_scalar_def : thm,
<A NAME="line92"></A>      varlist_insert_curried_def : thm,
<A NAME="line93"></A>      varlist_insert_tupled_primitive_def : thm,
<A NAME="line94"></A>      monom_insert_curried_def : thm,
<A NAME="line95"></A>      monom_insert_tupled_primitive_def : thm,
<A NAME="line96"></A>      canonical_sum_merge_curried_def : thm,
<A NAME="line97"></A>      canonical_sum_merge_tupled_primitive_def : thm,
<A NAME="line98"></A>      canonical_sum_size_def : thm,
<A NAME="line99"></A>      canonical_sum_case_def : thm,
<A NAME="line100"></A>      canonical_sum_repfns : thm,
<A NAME="line101"></A>      canonical_sum_TY_DEF : thm,
<A NAME="line102"></A>      spolynomial_simplify_ok : thm,
<A NAME="line103"></A>      spolynomial_normalize_ok : thm,
<A NAME="line104"></A>      spolynom_induction : thm,
<A NAME="line105"></A>      spolynom_Axiom : thm,
<A NAME="line106"></A>      spolynom_nchotomy : thm,
<A NAME="line107"></A>      spolynom_case_cong : thm,
<A NAME="line108"></A>      spolynom_distinct : thm,
<A NAME="line109"></A>      spolynom_11 : thm,
<A NAME="line110"></A>      datatype_spolynom : thm,
<A NAME="line111"></A>      canonical_sum_simplify_ok : thm,
<A NAME="line112"></A>      canonical_sum_prod_ok : thm,
<A NAME="line113"></A>      canonical_sum_scalar3_ok : thm,
<A NAME="line114"></A>      canonical_sum_scalar2_ok : thm,
<A NAME="line115"></A>      canonical_sum_scalar_ok : thm,
<A NAME="line116"></A>      varlist_insert_ok : thm,
<A NAME="line117"></A>      monom_insert_ok : thm,
<A NAME="line118"></A>      canonical_sum_merge_ok : thm,
<A NAME="line119"></A>      interp_m_ok : thm,
<A NAME="line120"></A>      ics_aux_ok : thm,
<A NAME="line121"></A>      varlist_merge_ok : thm,
<A NAME="line122"></A>      ivl_aux_ok : thm,
<A NAME="line123"></A>      varlist_insert_def : thm,
<A NAME="line124"></A>      varlist_insert_ind : thm,
<A NAME="line125"></A>      monom_insert_def : thm,
<A NAME="line126"></A>      monom_insert_ind : thm,
<A NAME="line127"></A>      canonical_sum_merge_def : thm,
<A NAME="line128"></A>      canonical_sum_merge_ind : thm,
<A NAME="line129"></A>      canonical_sum_induction : thm,
<A NAME="line130"></A>      canonical_sum_Axiom : thm,
<A NAME="line131"></A>      canonical_sum_nchotomy : thm,
<A NAME="line132"></A>      canonical_sum_case_cong : thm,
<A NAME="line133"></A>      canonical_sum_distinct : thm,
<A NAME="line134"></A>      canonical_sum_11 : thm,
<A NAME="line135"></A>      datatype_canonical_sum : thm }
<A NAME="line136"></A>  
<A NAME="line137"></A>(*
   [quote] Parent theory of "canonical"
   
   [semi_ring] Parent theory of "canonical"
   
   [<A NAME="canonical_sum_TY_DEF-val"><B>canonical_sum_TY_DEF</B></A>]  Definition
      
      |- ?rep.
           TYPE_DEFINITION
             (\a0'.
                !'canonical_sum' .
                  (!a0'.
                     (a0' =
                      ind_type$CONSTR 0 (ARB,ARB) (\n. ind_type$BOTTOM)) \/
                     (?a0 a1 a2.
                        (a0' =
                         (\a0 a1 a2.
                            ind_type$CONSTR (SUC 0) (a0,a1)
                              (ind_type$FCONS a2 (\n. ind_type$BOTTOM))) a0
                           a1 a2) /\ 'canonical_sum' a2) \/
                     (?a0 a1.
                        (a0' =
                         (\a0 a1.
                            ind_type$CONSTR (SUC (SUC 0)) (ARB,a0)
                              (ind_type$FCONS a1 (\n. ind_type$BOTTOM))) a0
                           a1) /\ 'canonical_sum' a1) ==&gt;
                     'canonical_sum' a0') ==&gt;
                  'canonical_sum' a0') rep
   
   [<A NAME="canonical_sum_case_def-val"><B>canonical_sum_case_def</B></A>]  Definition
      
      |- (!v f f1. canonical_sum_case v f f1 Nil_monom = v) /\
         (!v f f1 a0 a1 a2.
            canonical_sum_case v f f1 (Cons_monom a0 a1 a2) =
            f a0 a1 a2) /\
         !v f f1 a0 a1.
           canonical_sum_case v f f1 (Cons_varlist a0 a1) = f1 a0 a1
   
   [<A NAME="canonical_sum_merge_curried_def-val"><B>canonical_sum_merge_curried_def</B></A>]  Definition
      
      |- !x x1 x2.
           canonical_sum_merge x x1 x2 =
           canonical_sum_merge_tupled (x,x1,x2)
   
   [<A NAME="canonical_sum_merge_tupled_primitive_def-val"><B>canonical_sum_merge_tupled_primitive_def</B></A>]  Definition
      
      |- canonical_sum_merge_tupled =
         WFREC
           (@R.
              WF R /\
              (!l2 c2 t2 t1 l1 c1 sr.
                 R (sr,Cons_monom c1 l1 t1,t2)
                   (sr,Cons_monom c1 l1 t1,Cons_monom c2 l2 t2)) /\
              (!l1 c1 t2 l2 c2 t1 sr.
                 R (sr,t1,Cons_monom c2 l2 t2)
                   (sr,Cons_monom c1 l1 t1,Cons_monom c2 l2 t2)) /\
              (!l2 c2 l1 c1 t2 t1 sr.
                 R (sr,t1,t2)
                   (sr,Cons_monom c1 l1 t1,Cons_monom c2 l2 t2)) /\
              (!l2 t2 t1 l1 c1 sr.
                 R (sr,Cons_monom c1 l1 t1,t2)
                   (sr,Cons_monom c1 l1 t1,Cons_varlist l2 t2)) /\
              (!l1 c1 t2 l2 t1 sr.
                 R (sr,t1,Cons_varlist l2 t2)
                   (sr,Cons_monom c1 l1 t1,Cons_varlist l2 t2)) /\
              (!l2 l1 c1 t2 t1 sr.
                 R (sr,t1,t2)
                   (sr,Cons_monom c1 l1 t1,Cons_varlist l2 t2)) /\
              (!l2 c2 t2 t1 l1 sr.
                 R (sr,Cons_varlist l1 t1,t2)
                   (sr,Cons_varlist l1 t1,Cons_monom c2 l2 t2)) /\
              (!l1 t2 l2 c2 t1 sr.
                 R (sr,t1,Cons_monom c2 l2 t2)
                   (sr,Cons_varlist l1 t1,Cons_monom c2 l2 t2)) /\
              (!l2 c2 l1 t2 t1 sr.
                 R (sr,t1,t2)
                   (sr,Cons_varlist l1 t1,Cons_monom c2 l2 t2)) /\
              (!l2 l1 t2 t1 sr.
                 R (sr,t1,t2)
                   (sr,Cons_varlist l1 t1,Cons_varlist l2 t2)) /\
              (!l1 t2 l2 t1 sr.
                 R (sr,t1,Cons_varlist l2 t2)
                   (sr,Cons_varlist l1 t1,Cons_varlist l2 t2)) /\
              !l2 t2 t1 l1 sr.
                R (sr,Cons_varlist l1 t1,t2)
                  (sr,Cons_varlist l1 t1,Cons_varlist l2 t2))
           (\canonical_sum_merge_tupled a.
              case a of
                 (sr,Nil_monom,Nil_monom) -&gt; I Nil_monom
              || (sr,Nil_monom,Cons_monom v19 v20 v21) -&gt;
                   I (Cons_monom v19 v20 v21)
              || (sr,Nil_monom,Cons_varlist v22 v23) -&gt;
                   I (Cons_varlist v22 v23)
              || (sr,Cons_monom c1 l1 t1,Nil_monom) -&gt;
                   I (Cons_monom c1 l1 t1)
              || (sr,Cons_monom c1 l1 t1,Cons_monom c2 l2 t2) -&gt;
                   I
                     (compare (list_compare index_compare l1 l2)
                        (Cons_monom c1 l1
                           (canonical_sum_merge_tupled
                              (sr,t1,Cons_monom c2 l2 t2)))
                        (Cons_monom (SRP sr c1 c2) l1
                           (canonical_sum_merge_tupled (sr,t1,t2)))
                        (Cons_monom c2 l2
                           (canonical_sum_merge_tupled
                              (sr,Cons_monom c1 l1 t1,t2))))
              || (sr,Cons_monom c1 l1 t1,Cons_varlist l2' t2') -&gt;
                   I
                     (compare (list_compare index_compare l1 l2')
                        (Cons_monom c1 l1
                           (canonical_sum_merge_tupled
                              (sr,t1,Cons_varlist l2' t2')))
                        (Cons_monom (SRP sr c1 (SR1 sr)) l1
                           (canonical_sum_merge_tupled (sr,t1,t2')))
                        (Cons_varlist l2'
                           (canonical_sum_merge_tupled
                              (sr,Cons_monom c1 l1 t1,t2'))))
              || (sr,Cons_varlist l1' t1',Nil_monom) -&gt;
                   I (Cons_varlist l1' t1')
              || (sr,Cons_varlist l1' t1',Cons_monom c2' l2'' t2'') -&gt;
                   I
                     (compare (list_compare index_compare l1' l2'')
                        (Cons_varlist l1'
                           (canonical_sum_merge_tupled
                              (sr,t1',Cons_monom c2' l2'' t2'')))
                        (Cons_monom (SRP sr (SR1 sr) c2') l1'
                           (canonical_sum_merge_tupled (sr,t1',t2'')))
                        (Cons_monom c2' l2''
                           (canonical_sum_merge_tupled
                              (sr,Cons_varlist l1' t1',t2''))))
              || (sr,Cons_varlist l1' t1',Cons_varlist l2''' t2''') -&gt;
                   I
                     (compare (list_compare index_compare l1' l2''')
                        (Cons_varlist l1'
                           (canonical_sum_merge_tupled
                              (sr,t1',Cons_varlist l2''' t2''')))
                        (Cons_monom (SRP sr (SR1 sr) (SR1 sr)) l1'
                           (canonical_sum_merge_tupled (sr,t1',t2''')))
                        (Cons_varlist l2'''
                           (canonical_sum_merge_tupled
                              (sr,Cons_varlist l1' t1',t2''')))))
   
   [<A NAME="canonical_sum_prod_def-val"><B>canonical_sum_prod_def</B></A>]  Definition
      
      |- (!sr c1 l1 t1 s2.
            canonical_sum_prod sr (Cons_monom c1 l1 t1) s2 =
            canonical_sum_merge sr (canonical_sum_scalar3 sr c1 l1 s2)
              (canonical_sum_prod sr t1 s2)) /\
         (!sr l1 t1 s2.
            canonical_sum_prod sr (Cons_varlist l1 t1) s2 =
            canonical_sum_merge sr (canonical_sum_scalar2 sr l1 s2)
              (canonical_sum_prod sr t1 s2)) /\
         !sr s2. canonical_sum_prod sr Nil_monom s2 = Nil_monom
   
   [<A NAME="canonical_sum_repfns-val"><B>canonical_sum_repfns</B></A>]  Definition
      
      |- (!a. mk_canonical_sum (dest_canonical_sum a) = a) /\
         !r.
           (\a0'.
              !'canonical_sum' .
                (!a0'.
                   (a0' =
                    ind_type$CONSTR 0 (ARB,ARB) (\n. ind_type$BOTTOM)) \/
                   (?a0 a1 a2.
                      (a0' =
                       (\a0 a1 a2.
                          ind_type$CONSTR (SUC 0) (a0,a1)
                            (ind_type$FCONS a2 (\n. ind_type$BOTTOM))) a0
                         a1 a2) /\ 'canonical_sum' a2) \/
                   (?a0 a1.
                      (a0' =
                       (\a0 a1.
                          ind_type$CONSTR (SUC (SUC 0)) (ARB,a0)
                            (ind_type$FCONS a1 (\n. ind_type$BOTTOM))) a0
                         a1) /\ 'canonical_sum' a1) ==&gt;
                   'canonical_sum' a0') ==&gt;
                'canonical_sum' a0') r &lt;=&gt;
           (dest_canonical_sum (mk_canonical_sum r) = r)
   
   [<A NAME="canonical_sum_scalar2_def-val"><B>canonical_sum_scalar2_def</B></A>]  Definition
      
      |- (!sr l0 c l t.
            canonical_sum_scalar2 sr l0 (Cons_monom c l t) =
            monom_insert sr c (list_merge index_lt l0 l)
              (canonical_sum_scalar2 sr l0 t)) /\
         (!sr l0 l t.
            canonical_sum_scalar2 sr l0 (Cons_varlist l t) =
            varlist_insert sr (list_merge index_lt l0 l)
              (canonical_sum_scalar2 sr l0 t)) /\
         !sr l0. canonical_sum_scalar2 sr l0 Nil_monom = Nil_monom
   
   [<A NAME="canonical_sum_scalar3_def-val"><B>canonical_sum_scalar3_def</B></A>]  Definition
      
      |- (!sr c0 l0 c l t.
            canonical_sum_scalar3 sr c0 l0 (Cons_monom c l t) =
            monom_insert sr (SRM sr c0 c) (list_merge index_lt l0 l)
              (canonical_sum_scalar3 sr c0 l0 t)) /\
         (!sr c0 l0 l t.
            canonical_sum_scalar3 sr c0 l0 (Cons_varlist l t) =
            monom_insert sr c0 (list_merge index_lt l0 l)
              (canonical_sum_scalar3 sr c0 l0 t)) /\
         !sr c0 l0. canonical_sum_scalar3 sr c0 l0 Nil_monom = Nil_monom
   
   [<A NAME="canonical_sum_scalar_def-val"><B>canonical_sum_scalar_def</B></A>]  Definition
      
      |- (!sr c0 c l t.
            canonical_sum_scalar sr c0 (Cons_monom c l t) =
            Cons_monom (SRM sr c0 c) l (canonical_sum_scalar sr c0 t)) /\
         (!sr c0 l t.
            canonical_sum_scalar sr c0 (Cons_varlist l t) =
            Cons_monom c0 l (canonical_sum_scalar sr c0 t)) /\
         !sr c0. canonical_sum_scalar sr c0 Nil_monom = Nil_monom
   
   [<A NAME="canonical_sum_simplify_def-val"><B>canonical_sum_simplify_def</B></A>]  Definition
      
      |- (!sr c l t.
            canonical_sum_simplify sr (Cons_monom c l t) =
            if c = SR0 sr then
              canonical_sum_simplify sr t
            else
              if c = SR1 sr then
                Cons_varlist l (canonical_sum_simplify sr t)
              else
                Cons_monom c l (canonical_sum_simplify sr t)) /\
         (!sr l t.
            canonical_sum_simplify sr (Cons_varlist l t) =
            Cons_varlist l (canonical_sum_simplify sr t)) /\
         !sr. canonical_sum_simplify sr Nil_monom = Nil_monom
   
   [<A NAME="canonical_sum_size_def-val"><B>canonical_sum_size_def</B></A>]  Definition
      
      |- (!f. canonical_sum_size f Nil_monom = 0) /\
         (!f a0 a1 a2.
            canonical_sum_size f (Cons_monom a0 a1 a2) =
            1 +
            (f a0 +
             (list_size index_size a1 + canonical_sum_size f a2))) /\
         !f a0 a1.
           canonical_sum_size f (Cons_varlist a0 a1) =
           1 + (list_size index_size a0 + canonical_sum_size f a1)
   
   [<A NAME="ics_aux_def-val"><B>ics_aux_def</B></A>]  Definition
      
      |- (!sr vm a. ics_aux sr vm a Nil_monom = a) /\
         (!sr vm a l t.
            ics_aux sr vm a (Cons_varlist l t) =
            SRP sr a (ics_aux sr vm (interp_vl sr vm l) t)) /\
         !sr vm a c l t.
           ics_aux sr vm a (Cons_monom c l t) =
           SRP sr a (ics_aux sr vm (interp_m sr vm c l) t)
   
   [<A NAME="interp_cs_def-val"><B>interp_cs_def</B></A>]  Definition
      
      |- (!sr vm. interp_cs sr vm Nil_monom = SR0 sr) /\
         (!sr vm l t.
            interp_cs sr vm (Cons_varlist l t) =
            ics_aux sr vm (interp_vl sr vm l) t) /\
         !sr vm c l t.
           interp_cs sr vm (Cons_monom c l t) =
           ics_aux sr vm (interp_m sr vm c l) t
   
   [<A NAME="interp_m_def-val"><B>interp_m_def</B></A>]  Definition
      
      |- (!sr vm c. interp_m sr vm c [] = c) /\
         !sr vm c x t.
           interp_m sr vm c (x::t) = SRM sr c (ivl_aux sr vm x t)
   
   [<A NAME="interp_sp_def-val"><B>interp_sp_def</B></A>]  Definition
      
      |- (!sr vm c. interp_sp sr vm (SPconst c) = c) /\
         (!sr vm i. interp_sp sr vm (SPvar i) = varmap_find i vm) /\
         (!sr vm p1 p2.
            interp_sp sr vm (SPplus p1 p2) =
            SRP sr (interp_sp sr vm p1) (interp_sp sr vm p2)) /\
         !sr vm p1 p2.
           interp_sp sr vm (SPmult p1 p2) =
           SRM sr (interp_sp sr vm p1) (interp_sp sr vm p2)
   
   [<A NAME="interp_vl_def-val"><B>interp_vl_def</B></A>]  Definition
      
      |- (!sr vm. interp_vl sr vm [] = SR1 sr) /\
         !sr vm x t. interp_vl sr vm (x::t) = ivl_aux sr vm x t
   
   [<A NAME="ivl_aux_def-val"><B>ivl_aux_def</B></A>]  Definition
      
      |- (!sr vm x. ivl_aux sr vm x [] = varmap_find x vm) /\
         !sr vm x x' t'.
           ivl_aux sr vm x (x'::t') =
           SRM sr (varmap_find x vm) (ivl_aux sr vm x' t')
   
   [<A NAME="monom_insert_curried_def-val"><B>monom_insert_curried_def</B></A>]  Definition
      
      |- !x x1 x2 x3.
           monom_insert x x1 x2 x3 = monom_insert_tupled (x,x1,x2,x3)
   
   [<A NAME="monom_insert_tupled_primitive_def-val"><B>monom_insert_tupled_primitive_def</B></A>]  Definition
      
      |- monom_insert_tupled =
         WFREC
           (@R.
              WF R /\
              (!l2 c2 t2 l1 c1 sr.
                 R (sr,c1,l1,t2) (sr,c1,l1,Cons_monom c2 l2 t2)) /\
              !l2 t2 l1 c1 sr.
                R (sr,c1,l1,t2) (sr,c1,l1,Cons_varlist l2 t2))
           (\monom_insert_tupled a.
              case a of
                 (sr,c1,l1,Nil_monom) -&gt; I (Cons_monom c1 l1 Nil_monom)
              || (sr,c1,l1,Cons_monom c2 l2 t2) -&gt;
                   I
                     (compare (list_compare index_compare l1 l2)
                        (Cons_monom c1 l1 (Cons_monom c2 l2 t2))
                        (Cons_monom (SRP sr c1 c2) l1 t2)
                        (Cons_monom c2 l2
                           (monom_insert_tupled (sr,c1,l1,t2))))
              || (sr,c1,l1,Cons_varlist l2' t2') -&gt;
                   I
                     (compare (list_compare index_compare l1 l2')
                        (Cons_monom c1 l1 (Cons_varlist l2' t2'))
                        (Cons_monom (SRP sr c1 (SR1 sr)) l1 t2')
                        (Cons_varlist l2'
                           (monom_insert_tupled (sr,c1,l1,t2')))))
   
   [<A NAME="spolynom_TY_DEF-val"><B>spolynom_TY_DEF</B></A>]  Definition
      
      |- ?rep.
           TYPE_DEFINITION
             (\a0'.
                !'spolynom' .
                  (!a0'.
                     (?a.
                        a0' =
                        (\a.
                           ind_type$CONSTR 0 (a,ARB) (\n. ind_type$BOTTOM))
                          a) \/
                     (?a.
                        a0' =
                        (\a.
                           ind_type$CONSTR (SUC 0) (ARB,a)
                             (\n. ind_type$BOTTOM)) a) \/
                     (?a0 a1.
                        (a0' =
                         (\a0 a1.
                            ind_type$CONSTR (SUC (SUC 0)) (ARB,ARB)
                              (ind_type$FCONS a0
                                 (ind_type$FCONS a1
                                    (\n. ind_type$BOTTOM)))) a0 a1) /\
                        'spolynom' a0 /\ 'spolynom' a1) \/
                     (?a0 a1.
                        (a0' =
                         (\a0 a1.
                            ind_type$CONSTR (SUC (SUC (SUC 0))) (ARB,ARB)
                              (ind_type$FCONS a0
                                 (ind_type$FCONS a1
                                    (\n. ind_type$BOTTOM)))) a0 a1) /\
                        'spolynom' a0 /\ 'spolynom' a1) ==&gt;
                     'spolynom' a0') ==&gt;
                  'spolynom' a0') rep
   
   [<A NAME="spolynom_case_def-val"><B>spolynom_case_def</B></A>]  Definition
      
      |- (!f f1 f2 f3 a. spolynom_case f f1 f2 f3 (SPvar a) = f a) /\
         (!f f1 f2 f3 a. spolynom_case f f1 f2 f3 (SPconst a) = f1 a) /\
         (!f f1 f2 f3 a0 a1.
            spolynom_case f f1 f2 f3 (SPplus a0 a1) = f2 a0 a1) /\
         !f f1 f2 f3 a0 a1.
           spolynom_case f f1 f2 f3 (SPmult a0 a1) = f3 a0 a1
   
   [<A NAME="spolynom_normalize_def-val"><B>spolynom_normalize_def</B></A>]  Definition
      
      |- (!sr i.
            spolynom_normalize sr (SPvar i) =
            Cons_varlist [i] Nil_monom) /\
         (!sr c.
            spolynom_normalize sr (SPconst c) =
            Cons_monom c [] Nil_monom) /\
         (!sr l r.
            spolynom_normalize sr (SPplus l r) =
            canonical_sum_merge sr (spolynom_normalize sr l)
              (spolynom_normalize sr r)) /\
         !sr l r.
           spolynom_normalize sr (SPmult l r) =
           canonical_sum_prod sr (spolynom_normalize sr l)
             (spolynom_normalize sr r)
   
   [<A NAME="spolynom_repfns-val"><B>spolynom_repfns</B></A>]  Definition
      
      |- (!a. mk_spolynom (dest_spolynom a) = a) /\
         !r.
           (\a0'.
              !'spolynom' .
                (!a0'.
                   (?a.
                      a0' =
                      (\a. ind_type$CONSTR 0 (a,ARB) (\n. ind_type$BOTTOM))
                        a) \/
                   (?a.
                      a0' =
                      (\a.
                         ind_type$CONSTR (SUC 0) (ARB,a)
                           (\n. ind_type$BOTTOM)) a) \/
                   (?a0 a1.
                      (a0' =
                       (\a0 a1.
                          ind_type$CONSTR (SUC (SUC 0)) (ARB,ARB)
                            (ind_type$FCONS a0
                               (ind_type$FCONS a1 (\n. ind_type$BOTTOM))))
                         a0 a1) /\ 'spolynom' a0 /\ 'spolynom' a1) \/
                   (?a0 a1.
                      (a0' =
                       (\a0 a1.
                          ind_type$CONSTR (SUC (SUC (SUC 0))) (ARB,ARB)
                            (ind_type$FCONS a0
                               (ind_type$FCONS a1 (\n. ind_type$BOTTOM))))
                         a0 a1) /\ 'spolynom' a0 /\ 'spolynom' a1) ==&gt;
                   'spolynom' a0') ==&gt;
                'spolynom' a0') r &lt;=&gt; (dest_spolynom (mk_spolynom r) = r)
   
   [<A NAME="spolynom_simplify_def-val"><B>spolynom_simplify_def</B></A>]  Definition
      
      |- !sr x.
           spolynom_simplify sr x =
           canonical_sum_simplify sr (spolynom_normalize sr x)
   
   [<A NAME="spolynom_size_def-val"><B>spolynom_size_def</B></A>]  Definition
      
      |- (!f a. spolynom_size f (SPvar a) = 1 + index_size a) /\
         (!f a. spolynom_size f (SPconst a) = 1 + f a) /\
         (!f a0 a1.
            spolynom_size f (SPplus a0 a1) =
            1 + (spolynom_size f a0 + spolynom_size f a1)) /\
         !f a0 a1.
           spolynom_size f (SPmult a0 a1) =
           1 + (spolynom_size f a0 + spolynom_size f a1)
   
   [<A NAME="varlist_insert_curried_def-val"><B>varlist_insert_curried_def</B></A>]  Definition
      
      |- !x x1 x2. varlist_insert x x1 x2 = varlist_insert_tupled (x,x1,x2)
   
   [<A NAME="varlist_insert_tupled_primitive_def-val"><B>varlist_insert_tupled_primitive_def</B></A>]  Definition
      
      |- varlist_insert_tupled =
         WFREC
           (@R.
              WF R /\
              (!l2 c2 t2 l1 sr.
                 R (sr,l1,t2) (sr,l1,Cons_monom c2 l2 t2)) /\
              !l2 t2 l1 sr. R (sr,l1,t2) (sr,l1,Cons_varlist l2 t2))
           (\varlist_insert_tupled a.
              case a of
                 (sr,l1,Nil_monom) -&gt; I (Cons_varlist l1 Nil_monom)
              || (sr,l1,Cons_monom c2 l2 t2) -&gt;
                   I
                     (compare (list_compare index_compare l1 l2)
                        (Cons_varlist l1 (Cons_monom c2 l2 t2))
                        (Cons_monom (SRP sr (SR1 sr) c2) l1 t2)
                        (Cons_monom c2 l2
                           (varlist_insert_tupled (sr,l1,t2))))
              || (sr,l1,Cons_varlist l2' t2') -&gt;
                   I
                     (compare (list_compare index_compare l1 l2')
                        (Cons_varlist l1 (Cons_varlist l2' t2'))
                        (Cons_monom (SRP sr (SR1 sr) (SR1 sr)) l1 t2')
                        (Cons_varlist l2'
                           (varlist_insert_tupled (sr,l1,t2')))))
   
   [<A NAME="canonical_sum_11-val"><B>canonical_sum_11</B></A>]  Theorem
      
      |- (!a0 a1 a2 a0' a1' a2'.
            (Cons_monom a0 a1 a2 = Cons_monom a0' a1' a2') &lt;=&gt;
            (a0 = a0') /\ (a1 = a1') /\ (a2 = a2')) /\
         !a0 a1 a0' a1'.
           (Cons_varlist a0 a1 = Cons_varlist a0' a1') &lt;=&gt;
           (a0 = a0') /\ (a1 = a1')
   
   [<A NAME="canonical_sum_Axiom-val"><B>canonical_sum_Axiom</B></A>]  Theorem
      
      |- !f0 f1 f2.
           ?fn.
             (fn Nil_monom = f0) /\
             (!a0 a1 a2. fn (Cons_monom a0 a1 a2) = f1 a0 a1 a2 (fn a2)) /\
             !a0 a1. fn (Cons_varlist a0 a1) = f2 a0 a1 (fn a1)
   
   [<A NAME="canonical_sum_case_cong-val"><B>canonical_sum_case_cong</B></A>]  Theorem
      
      |- !M M' v f f1.
           (M = M') /\ ((M' = Nil_monom) ==&gt; (v = v')) /\
           (!a0 a1 a2.
              (M' = Cons_monom a0 a1 a2) ==&gt; (f a0 a1 a2 = f' a0 a1 a2)) /\
           (!a0 a1.
              (M' = Cons_varlist a0 a1) ==&gt; (f1 a0 a1 = f1' a0 a1)) ==&gt;
           (canonical_sum_case v f f1 M = canonical_sum_case v' f' f1' M')
   
   [<A NAME="canonical_sum_distinct-val"><B>canonical_sum_distinct</B></A>]  Theorem
      
      |- (!a2 a1 a0. Nil_monom &lt;&gt; Cons_monom a0 a1 a2) /\
         (!a1 a0. Nil_monom &lt;&gt; Cons_varlist a0 a1) /\
         !a2 a1' a1 a0' a0. Cons_monom a0 a1 a2 &lt;&gt; Cons_varlist a0' a1'
   
   [<A NAME="canonical_sum_induction-val"><B>canonical_sum_induction</B></A>]  Theorem
      
      |- !P.
           P Nil_monom /\ (!c. P c ==&gt; !l a. P (Cons_monom a l c)) /\
           (!c. P c ==&gt; !l. P (Cons_varlist l c)) ==&gt;
           !c. P c
   
   [<A NAME="canonical_sum_merge_def-val"><B>canonical_sum_merge_def</B></A>]  Theorem
      
      |- (!t2 t1 sr l2 l1 c2 c1.
            canonical_sum_merge sr (Cons_monom c1 l1 t1)
              (Cons_monom c2 l2 t2) =
            compare (list_compare index_compare l1 l2)
              (Cons_monom c1 l1
                 (canonical_sum_merge sr t1 (Cons_monom c2 l2 t2)))
              (Cons_monom (SRP sr c1 c2) l1 (canonical_sum_merge sr t1 t2))
              (Cons_monom c2 l2
                 (canonical_sum_merge sr (Cons_monom c1 l1 t1) t2))) /\
         (!t2 t1 sr l2 l1 c1.
            canonical_sum_merge sr (Cons_monom c1 l1 t1)
              (Cons_varlist l2 t2) =
            compare (list_compare index_compare l1 l2)
              (Cons_monom c1 l1
                 (canonical_sum_merge sr t1 (Cons_varlist l2 t2)))
              (Cons_monom (SRP sr c1 (SR1 sr)) l1
                 (canonical_sum_merge sr t1 t2))
              (Cons_varlist l2
                 (canonical_sum_merge sr (Cons_monom c1 l1 t1) t2))) /\
         (!t2 t1 sr l2 l1 c2.
            canonical_sum_merge sr (Cons_varlist l1 t1)
              (Cons_monom c2 l2 t2) =
            compare (list_compare index_compare l1 l2)
              (Cons_varlist l1
                 (canonical_sum_merge sr t1 (Cons_monom c2 l2 t2)))
              (Cons_monom (SRP sr (SR1 sr) c2) l1
                 (canonical_sum_merge sr t1 t2))
              (Cons_monom c2 l2
                 (canonical_sum_merge sr (Cons_varlist l1 t1) t2))) /\
         (!t2 t1 sr l2 l1.
            canonical_sum_merge sr (Cons_varlist l1 t1)
              (Cons_varlist l2 t2) =
            compare (list_compare index_compare l1 l2)
              (Cons_varlist l1
                 (canonical_sum_merge sr t1 (Cons_varlist l2 t2)))
              (Cons_monom (SRP sr (SR1 sr) (SR1 sr)) l1
                 (canonical_sum_merge sr t1 t2))
              (Cons_varlist l2
                 (canonical_sum_merge sr (Cons_varlist l1 t1) t2))) /\
         (!sr. canonical_sum_merge sr Nil_monom Nil_monom = Nil_monom) /\
         (!v6 v5 v4 sr.
            canonical_sum_merge sr (Cons_monom v4 v5 v6) Nil_monom =
            Cons_monom v4 v5 v6) /\
         (!v8 v7 sr.
            canonical_sum_merge sr (Cons_varlist v7 v8) Nil_monom =
            Cons_varlist v7 v8) /\
         (!v16 v15 v14 sr.
            canonical_sum_merge sr Nil_monom (Cons_monom v14 v15 v16) =
            Cons_monom v14 v15 v16) /\
         !v18 v17 sr.
           canonical_sum_merge sr Nil_monom (Cons_varlist v17 v18) =
           Cons_varlist v17 v18
   
   [<A NAME="canonical_sum_merge_ind-val"><B>canonical_sum_merge_ind</B></A>]  Theorem
      
      |- !P.
           (!sr c1 l1 t1 c2 l2 t2.
              P sr t1 t2 /\ P sr t1 (Cons_monom c2 l2 t2) /\
              P sr (Cons_monom c1 l1 t1) t2 ==&gt;
              P sr (Cons_monom c1 l1 t1) (Cons_monom c2 l2 t2)) /\
           (!sr c1 l1 t1 l2 t2.
              P sr t1 t2 /\ P sr t1 (Cons_varlist l2 t2) /\
              P sr (Cons_monom c1 l1 t1) t2 ==&gt;
              P sr (Cons_monom c1 l1 t1) (Cons_varlist l2 t2)) /\
           (!sr l1 t1 c2 l2 t2.
              P sr t1 t2 /\ P sr t1 (Cons_monom c2 l2 t2) /\
              P sr (Cons_varlist l1 t1) t2 ==&gt;
              P sr (Cons_varlist l1 t1) (Cons_monom c2 l2 t2)) /\
           (!sr l1 t1 l2 t2.
              P sr t1 t2 /\ P sr t1 (Cons_varlist l2 t2) /\
              P sr (Cons_varlist l1 t1) t2 ==&gt;
              P sr (Cons_varlist l1 t1) (Cons_varlist l2 t2)) /\
           (!sr. P sr Nil_monom Nil_monom) /\
           (!sr v4 v5 v6. P sr (Cons_monom v4 v5 v6) Nil_monom) /\
           (!sr v7 v8. P sr (Cons_varlist v7 v8) Nil_monom) /\
           (!sr v14 v15 v16. P sr Nil_monom (Cons_monom v14 v15 v16)) /\
           (!sr v17 v18. P sr Nil_monom (Cons_varlist v17 v18)) ==&gt;
           !v v1 v2. P v v1 v2
   
   [<A NAME="canonical_sum_merge_ok-val"><B>canonical_sum_merge_ok</B></A>]  Theorem
      
      |- !sr.
           is_semi_ring sr ==&gt;
           !vm x y.
             interp_cs sr vm (canonical_sum_merge sr x y) =
             SRP sr (interp_cs sr vm x) (interp_cs sr vm y)
   
   [<A NAME="canonical_sum_nchotomy-val"><B>canonical_sum_nchotomy</B></A>]  Theorem
      
      |- !cc.
           (cc = Nil_monom) \/ (?a l c. cc = Cons_monom a l c) \/
           ?l c. cc = Cons_varlist l c
   
   [<A NAME="canonical_sum_prod_ok-val"><B>canonical_sum_prod_ok</B></A>]  Theorem
      
      |- !sr.
           is_semi_ring sr ==&gt;
           !vm x y.
             interp_cs sr vm (canonical_sum_prod sr x y) =
             SRM sr (interp_cs sr vm x) (interp_cs sr vm y)
   
   [<A NAME="canonical_sum_scalar2_ok-val"><B>canonical_sum_scalar2_ok</B></A>]  Theorem
      
      |- !sr.
           is_semi_ring sr ==&gt;
           !vm l s.
             interp_cs sr vm (canonical_sum_scalar2 sr l s) =
             SRM sr (interp_vl sr vm l) (interp_cs sr vm s)
   
   [<A NAME="canonical_sum_scalar3_ok-val"><B>canonical_sum_scalar3_ok</B></A>]  Theorem
      
      |- !sr.
           is_semi_ring sr ==&gt;
           !vm c l s.
             interp_cs sr vm (canonical_sum_scalar3 sr c l s) =
             SRM sr (SRM sr c (interp_vl sr vm l)) (interp_cs sr vm s)
   
   [<A NAME="canonical_sum_scalar_ok-val"><B>canonical_sum_scalar_ok</B></A>]  Theorem
      
      |- !sr.
           is_semi_ring sr ==&gt;
           !vm a s.
             interp_cs sr vm (canonical_sum_scalar sr a s) =
             SRM sr a (interp_cs sr vm s)
   
   [<A NAME="canonical_sum_simplify_ok-val"><B>canonical_sum_simplify_ok</B></A>]  Theorem
      
      |- !sr.
           is_semi_ring sr ==&gt;
           !vm s.
             interp_cs sr vm (canonical_sum_simplify sr s) =
             interp_cs sr vm s
   
   [<A NAME="datatype_canonical_sum-val"><B>datatype_canonical_sum</B></A>]  Theorem
      
      |- DATATYPE (canonical_sum Nil_monom Cons_monom Cons_varlist)
   
   [<A NAME="datatype_spolynom-val"><B>datatype_spolynom</B></A>]  Theorem
      
      |- DATATYPE (spolynom SPvar SPconst SPplus SPmult)
   
   [<A NAME="ics_aux_ok-val"><B>ics_aux_ok</B></A>]  Theorem
      
      |- !sr.
           is_semi_ring sr ==&gt;
           !vm x s. ics_aux sr vm x s = SRP sr x (interp_cs sr vm s)
   
   [<A NAME="interp_m_ok-val"><B>interp_m_ok</B></A>]  Theorem
      
      |- !sr.
           is_semi_ring sr ==&gt;
           !vm x l. interp_m sr vm x l = SRM sr x (interp_vl sr vm l)
   
   [<A NAME="ivl_aux_ok-val"><B>ivl_aux_ok</B></A>]  Theorem
      
      |- !sr.
           is_semi_ring sr ==&gt;
           !vm v i.
             ivl_aux sr vm i v =
             SRM sr (varmap_find i vm) (interp_vl sr vm v)
   
   [<A NAME="monom_insert_def-val"><B>monom_insert_def</B></A>]  Theorem
      
      |- (!t2 sr l2 l1 c2 c1.
            monom_insert sr c1 l1 (Cons_monom c2 l2 t2) =
            compare (list_compare index_compare l1 l2)
              (Cons_monom c1 l1 (Cons_monom c2 l2 t2))
              (Cons_monom (SRP sr c1 c2) l1 t2)
              (Cons_monom c2 l2 (monom_insert sr c1 l1 t2))) /\
         (!t2 sr l2 l1 c1.
            monom_insert sr c1 l1 (Cons_varlist l2 t2) =
            compare (list_compare index_compare l1 l2)
              (Cons_monom c1 l1 (Cons_varlist l2 t2))
              (Cons_monom (SRP sr c1 (SR1 sr)) l1 t2)
              (Cons_varlist l2 (monom_insert sr c1 l1 t2))) /\
         !sr l1 c1.
           monom_insert sr c1 l1 Nil_monom = Cons_monom c1 l1 Nil_monom
   
   [<A NAME="monom_insert_ind-val"><B>monom_insert_ind</B></A>]  Theorem
      
      |- !P.
           (!sr c1 l1 c2 l2 t2.
              P sr c1 l1 t2 ==&gt; P sr c1 l1 (Cons_monom c2 l2 t2)) /\
           (!sr c1 l1 l2 t2.
              P sr c1 l1 t2 ==&gt; P sr c1 l1 (Cons_varlist l2 t2)) /\
           (!sr c1 l1. P sr c1 l1 Nil_monom) ==&gt;
           !v v1 v2 v3. P v v1 v2 v3
   
   [<A NAME="monom_insert_ok-val"><B>monom_insert_ok</B></A>]  Theorem
      
      |- !sr.
           is_semi_ring sr ==&gt;
           !vm a l s.
             interp_cs sr vm (monom_insert sr a l s) =
             SRP sr (SRM sr a (interp_vl sr vm l)) (interp_cs sr vm s)
   
   [<A NAME="spolynom_11-val"><B>spolynom_11</B></A>]  Theorem
      
      |- (!a a'. (SPvar a = SPvar a') &lt;=&gt; (a = a')) /\
         (!a a'. (SPconst a = SPconst a') &lt;=&gt; (a = a')) /\
         (!a0 a1 a0' a1'.
            (SPplus a0 a1 = SPplus a0' a1') &lt;=&gt;
            (a0 = a0') /\ (a1 = a1')) /\
         !a0 a1 a0' a1'.
           (SPmult a0 a1 = SPmult a0' a1') &lt;=&gt; (a0 = a0') /\ (a1 = a1')
   
   [<A NAME="spolynom_Axiom-val"><B>spolynom_Axiom</B></A>]  Theorem
      
      |- !f0 f1 f2 f3.
           ?fn.
             (!a. fn (SPvar a) = f0 a) /\ (!a. fn (SPconst a) = f1 a) /\
             (!a0 a1. fn (SPplus a0 a1) = f2 a0 a1 (fn a0) (fn a1)) /\
             !a0 a1. fn (SPmult a0 a1) = f3 a0 a1 (fn a0) (fn a1)
   
   [<A NAME="spolynom_case_cong-val"><B>spolynom_case_cong</B></A>]  Theorem
      
      |- !M M' f f1 f2 f3.
           (M = M') /\ (!a. (M' = SPvar a) ==&gt; (f a = f' a)) /\
           (!a. (M' = SPconst a) ==&gt; (f1 a = f1' a)) /\
           (!a0 a1. (M' = SPplus a0 a1) ==&gt; (f2 a0 a1 = f2' a0 a1)) /\
           (!a0 a1. (M' = SPmult a0 a1) ==&gt; (f3 a0 a1 = f3' a0 a1)) ==&gt;
           (spolynom_case f f1 f2 f3 M = spolynom_case f' f1' f2' f3' M')
   
   [<A NAME="spolynom_distinct-val"><B>spolynom_distinct</B></A>]  Theorem
      
      |- (!a' a. SPvar a &lt;&gt; SPconst a') /\
         (!a1 a0 a. SPvar a &lt;&gt; SPplus a0 a1) /\
         (!a1 a0 a. SPvar a &lt;&gt; SPmult a0 a1) /\
         (!a1 a0 a. SPconst a &lt;&gt; SPplus a0 a1) /\
         (!a1 a0 a. SPconst a &lt;&gt; SPmult a0 a1) /\
         !a1' a1 a0' a0. SPplus a0 a1 &lt;&gt; SPmult a0' a1'
   
   [<A NAME="spolynom_induction-val"><B>spolynom_induction</B></A>]  Theorem
      
      |- !P.
           (!i. P (SPvar i)) /\ (!a. P (SPconst a)) /\
           (!s s0. P s /\ P s0 ==&gt; P (SPplus s s0)) /\
           (!s s0. P s /\ P s0 ==&gt; P (SPmult s s0)) ==&gt;
           !s. P s
   
   [<A NAME="spolynom_nchotomy-val"><B>spolynom_nchotomy</B></A>]  Theorem
      
      |- !ss.
           (?i. ss = SPvar i) \/ (?a. ss = SPconst a) \/
           (?s s0. ss = SPplus s s0) \/ ?s s0. ss = SPmult s s0
   
   [<A NAME="spolynomial_normalize_ok-val"><B>spolynomial_normalize_ok</B></A>]  Theorem
      
      |- !sr.
           is_semi_ring sr ==&gt;
           !vm p.
             interp_cs sr vm (spolynom_normalize sr p) = interp_sp sr vm p
   
   [<A NAME="spolynomial_simplify_ok-val"><B>spolynomial_simplify_ok</B></A>]  Theorem
      
      |- !sr.
           is_semi_ring sr ==&gt;
           !vm p.
             interp_cs sr vm (spolynom_simplify sr p) = interp_sp sr vm p
   
   [<A NAME="varlist_insert_def-val"><B>varlist_insert_def</B></A>]  Theorem
      
      |- (!t2 sr l2 l1 c2.
            varlist_insert sr l1 (Cons_monom c2 l2 t2) =
            compare (list_compare index_compare l1 l2)
              (Cons_varlist l1 (Cons_monom c2 l2 t2))
              (Cons_monom (SRP sr (SR1 sr) c2) l1 t2)
              (Cons_monom c2 l2 (varlist_insert sr l1 t2))) /\
         (!t2 sr l2 l1.
            varlist_insert sr l1 (Cons_varlist l2 t2) =
            compare (list_compare index_compare l1 l2)
              (Cons_varlist l1 (Cons_varlist l2 t2))
              (Cons_monom (SRP sr (SR1 sr) (SR1 sr)) l1 t2)
              (Cons_varlist l2 (varlist_insert sr l1 t2))) /\
         !sr l1. varlist_insert sr l1 Nil_monom = Cons_varlist l1 Nil_monom
   
   [<A NAME="varlist_insert_ind-val"><B>varlist_insert_ind</B></A>]  Theorem
      
      |- !P.
           (!sr l1 c2 l2 t2.
              P sr l1 t2 ==&gt; P sr l1 (Cons_monom c2 l2 t2)) /\
           (!sr l1 l2 t2. P sr l1 t2 ==&gt; P sr l1 (Cons_varlist l2 t2)) /\
           (!sr l1. P sr l1 Nil_monom) ==&gt;
           !v v1 v2. P v v1 v2
   
   [<A NAME="varlist_insert_ok-val"><B>varlist_insert_ok</B></A>]  Theorem
      
      |- !sr.
           is_semi_ring sr ==&gt;
           !vm l s.
             interp_cs sr vm (varlist_insert sr l s) =
             SRP sr (interp_vl sr vm l) (interp_cs sr vm s)
   
   [<A NAME="varlist_merge_ok-val"><B>varlist_merge_ok</B></A>]  Theorem
      
      |- !sr.
           is_semi_ring sr ==&gt;
           !vm x y.
             interp_vl sr vm (list_merge index_lt x y) =
             SRM sr (interp_vl sr vm x) (interp_vl sr vm y)
   
   
*)
end

</PRE><HR><TABLE WIDTH=100%><TR ALIGN = CENTER>
<TH><A HREF="../../../src/ring/src/canonicalScript.sml" type="text/plain">Source File</A>
<TH><A HREF="idIndex.html">Identifier index</A>
<TH><A HREF="TheoryIndex.html">Theory binding index</A>
</TABLE><HR>
<BR><EM><A HREF="http://hol.sourceforge.net">HOL&nbsp;4,&nbsp;Kananaskis-5</EM></BODY></HTML>
